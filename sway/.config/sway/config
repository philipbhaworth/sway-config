# Custom Sway configuration (Laptop)
# Updated for Debian 13 + Sway + Wayland helpers
# Reference: man 5 sway

### Variables
set $mod Mod4
set $left h
set $down j
set $up   k
set $right l
set $term kitty
set $filebrowser thunar
set $menu wofi --show drun
set $browser firefox
set $chat vesktop
set $power-menu ~/sway-config/sway-scripts/wofi-power.sh
set $wall ~/wallpapers/walls_02.png

### Export env so portals/session services behave in Wayland
exec_always dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=sway SWAYSOCK
exec_always systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP SWAYSOCK

### Output Configuration
# Wallpaper; Sway will spawn swaybg for this
output * bg $wall fill

# Laptop display example (uncomment/tune if needed)
# output eDP-1 scale 1.25

# Docked dual-monitor examples (commented)
# output DP-1 resolution 3840x2160 position 0,0    scale 1
# output DP-2 resolution 3840x2160 position 3840,0 scale 1

### Input Configuration
input type:keyboard {
    xkb_layout "us"
    xkb_options "caps:super,compose:ralt"
}

### Window Focus & Movement
bindsym $mod+$left  focus left
bindsym $mod+$down  focus down
bindsym $mod+$up    focus up
bindsym $mod+$right focus right
bindsym $mod+Left   focus left
bindsym $mod+Down   focus down
bindsym $mod+Up     focus up
bindsym $mod+Right  focus right

bindsym $mod+Shift+$left  move left
bindsym $mod+Shift+$down  move down
bindsym $mod+Shift+$up    move up
bindsym $mod+Shift+$right move right
bindsym $mod+Shift+Left   move left
bindsym $mod+Shift+Down   move down
bindsym $mod+Shift+Up     move up
bindsym $mod+Shift+Right  move right

bindsym $mod+q kill
bindsym $mod+f fullscreen
bindsym $mod+space focus mode_toggle
bindsym $mod+Shift+space floating toggle

### Workspaces
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10

bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9
bindsym $mod+Shift+0 move container to workspace number 10

# Prev/next workspace (deduped; arrows and hjkl both supported)
bindsym $mod+Ctrl+Left  exec swaymsg workspace prev
bindsym $mod+Ctrl+Right exec swaymsg workspace next
bindsym $mod+Ctrl+$left  exec swaymsg workspace prev
bindsym $mod+Ctrl+$right exec swaymsg workspace next

### Layout Controls
bindsym $mod+b splith
bindsym $mod+v splitv
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

bindsym $mod+Shift+minus move scratchpad
bindsym $mod+minus scratchpad show

### Launchers
# Core
bindsym $mod+Return exec $term
bindsym $mod+d exec $menu

# File managers
bindsym $mod+n exec $filebrowser
bindsym $mod+t exec thunar

# Browsers / comms
bindsym $mod+Shift+b exec $browser
bindsym $mod+g exec google-chrome-stable
bindsym $mod+Shift+d [app_id="vesktop"] focus; exec vesktop

# Editors / IDEs
bindsym $mod+c exec codium
bindsym $mod+x exec subl
bindsym $mod+Shift+t exec flatpak run org.gnome.TextEditor
bindsym $mod+p exec pluma

# Other apps
bindsym $mod+o exec flatpak run md.obsidian.Obsidian

# Session controls
bindsym $mod+Shift+r reload
bindsym $mod+Shift+q exec swaynag -t warning -m 'Do you really want to exit sway?' -B 'Yes' 'swaymsg exit'

### Tools & Utilities
bindsym $mod+Shift+s exec grim -g "$(slurp)" - | swappy -f -
bindsym Print exec grim
bindsym $mod+Shift+p exec hyprpicker -a && notify-send "Color picked" "$(wl-paste)"
bindsym $mod+Shift+v exec bash -lc "cliphist list | wofi --dmenu | cliphist decode | wl-copy"
bindsym $mod+Shift+x exec $power-menu

### Focus behavior
focus_follows_mouse no

### Gaps
gaps inner 10
gaps outer 5
smart_gaps on
smart_borders on

bindsym $mod+comma  gaps inner all minus 5
bindsym $mod+period gaps inner all plus 5
bindsym $mod+Shift+comma  gaps outer all minus 5
bindsym $mod+Shift+period gaps outer all plus 5

### Window appearance (Everforest-ish)
default_border pixel 2
default_floating_border pixel 2
hide_edge_borders smart

client.focused          #d3c6aa #2b3339 #d3c6aa #d3c6aa #d3c6aa
client.focused_inactive #3c474d #323c41 #d3c6aa #3c474d #3c474d
client.unfocused        #2b3339 #2b3339 #d3c6aa #2b3339 #2b3339
client.urgent           #e67e80 #e67e80 #2b3339 #e67e80 #e67e80

### Media & Hardware keys (PipeWire via wpctl)

# Audio
bindsym --locked XF86AudioMute        exec wpctl set-mute   @DEFAULT_AUDIO_SINK@ toggle
bindsym --locked XF86AudioLowerVolume exec wpctl set-volume -l 1.0 @DEFAULT_AUDIO_SINK@ 5%-
bindsym --locked XF86AudioRaiseVolume exec wpctl set-volume -l 1.0 @DEFAULT_AUDIO_SINK@ 5%+
bindsym --locked XF86AudioMicMute     exec wpctl set-mute   @DEFAULT_AUDIO_SOURCE@ toggle

# F-key fallbacks (when FnLock is off and keys emit F2/F3/F4)
bindsym --locked F2 exec wpctl set-volume -l 1.0 @DEFAULT_AUDIO_SINK@ 5%-
bindsym --locked F3 exec wpctl set-volume -l 1.0 @DEFAULT_AUDIO_SINK@ 5%+
bindsym --locked F4 exec wpctl set-mute   @DEFAULT_AUDIO_SOURCE@ toggle

# Brightness
bindsym --locked XF86MonBrightnessDown exec brightnessctl set 5%-
bindsym --locked XF86MonBrightnessUp   exec brightnessctl set 5%+
bindsym --locked F5 exec brightnessctl set 5%-
bindsym --locked F6 exec brightnessctl set 5%+


### Idle + Lock
exec --no-startup-id swayidle -w \
  timeout 300 'swaylock -f -c 000000' \
  timeout 600 'swaymsg "output * power off"' \
  resume 'swaymsg "output * power on"' \
  before-sleep 'swaylock -f -c 000000'

### Bar (Waybar)
bar {
    swaybar_command waybar
}

### Autostart
# Clipboard history
exec_always wl-paste -t text  --watch cliphist store
exec_always wl-paste -t image --watch cliphist store

# Notifications
exec_always swaync

# Network & Bluetooth applets
exec --no-startup-id nm-applet --indicator
exec --no-startup-id blueman-applet

# Automount removable media
exec --no-startup-id udiskie -t

# NOTE: Do not manually spawn xdg-desktop-portal*; let systemd/dbus manage them.

### Include system defaults (after ours so ours can override via later 'include' if desired)
include /etc/sway/config-vars.d/*
include /etc/sway/config.d/*
